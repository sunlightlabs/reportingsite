{% extends "willard/willard_base.html" %}

{% block breadcrumb %}
{{ block.super }}
{% if plural %}
<li><a href="{{ object.get_absolute_url }}/../">{{ plural }}</a></li>
{% if object %}
<li>{{ object }}</li>
{% endif %}
{% endif %}
{% endblock %}

{% block content %}

{% if object.get_rss_url %}
<a style="display: block; float: right;margin-top:10px;" href="{{ object.get_rss_url }}"><img src="http://assets.sunlightfoundation.com.s3.amazonaws.com/reporting/1.0/img/feed-icon-14x14.png" alt="RSS" title="Subscribe to an RSS feed of this data" style="border: 0;" /></a>
{% endif %}

<h2>
    {% if object %}
    {{ object }}
    {% else %}
    All registrations
    {% endif %}
</h2>
{% if object.ie_id %}
<p class="tip"><a href="{{ object.ie_url }}">Get more information at Influence Explorer</a></p>
{% endif %}
<br />

<table class="tablesorter">
    <thead>
        <tr>
            <th class="sort header{% ifequal order 'received' %} {% ifequal sort 'asc' %}headerSortUp{% else %}headerSortDown{% endifequal %}{% endifequal %}"><a href="?order={% ifequal order 'received' %}{% ifequal sort 'asc' %}-{% endifequal %}{% endifequal %}received">Date</a></th>
            <th class="sort header{% ifequal order 'registrant' %} {% ifequal sort 'asc' %}headerSortUp{% else %}headerSortDown{% endifequal %}{% endifequal %}"><a href="?order={% ifequal order 'registrant' %}{% ifequal sort 'asc' %}-{% endifequal %}{% endifequal %}registrant">Registrant</a></th>
            <th class="sort header{% ifequal order 'client' %} {% ifequal sort 'asc' %}headerSortUp{% else %}headerSortDown{% endifequal %}{% endifequal %}"><a href="?order={% ifequal order 'client' %}{% ifequal sort 'asc' %}-{% endifequal %}{% endifequal %}client">Client</a></th>
            <th style="width: 100px;">Issues</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for registration in object_list %}
        <tr class="{% cycle 'even' 'odd' %}">
            <td>{{ registration.received.date|date:"n/j/y" }}</td>
            <td><a href="{{ registration.registrant.get_absolute_url }}">{{ registration.registrant }}</a></td>
            <td><a href="{{ registration.client.get_absolute_url }}">{{ registration.client }}</a></td>
            <td>{% for issue in registration.denormalized_issues %}<a href="{{ issue.get_absolute_url }}">{{ issue }}</a>{% if not forloop.last %}, {% endif %}{% endfor %}</td>
            <td><a href="{{ registration.get_absolute_url }}">View registration</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% include "willard/pagination.html" %}

{% endblock %}
